import{s as U,r as a,j as t}from"./index-DPGGWdk_.js";import{S as f}from"./sweetalert2.esm.all-BQIkj5Wb.js";const E=async(d,c,i,u,s,p)=>{const{data:l,error:n}=await U.from("outdoor_locations").insert([{img_url:d,location:c,size:i,type:u,outdoor_slug:s,img_order:p}]);return{success:!n,data:l,error:n}},D=()=>{const[d,c]=a.useState(null),[i,u]=a.useState(null),[s,p]=a.useState(!1),[l,n]=a.useState(""),[g,w]=a.useState(""),[m,b]=a.useState(""),[h,y]=a.useState(""),[v,x]=a.useState(1),j="dtvdu1fqj",O="uploads";a.useEffect(()=>{(async()=>{try{const S=(await(await fetch("/api/getMaxOrder")).json()).maxOrder||0;x(S+1)}catch(r){console.error("Error fetching max order:",r)}})()},[]);const N=e=>{var o;const r=(o=e.target.files)==null?void 0:o[0];r&&(u(URL.createObjectURL(r)),c(r))},C=async()=>{if(!d||!l||!g||!m||!h){f.fire("Please fill in all fields and select an image.");return}p(!0);try{const e=new FormData;e.append("file",d),e.append("upload_preset",O);const o=await(await fetch(`https://api.cloudinary.com/v1_1/${j}/image/upload`,{method:"POST",body:e})).json();if(!o.secure_url)throw new Error("Upload to Cloudinary failed.");if((await E(o.secure_url,l,g,m,h,v)).success)f.fire("Image uploaded and saved!","","success"),c(null),u(null),n(""),w(""),b(""),y(""),x(1);else throw new Error("Saving to DB failed.")}catch(e){f.fire("Something went wrong.",e.message,"error")}finally{p(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-100 py-10 px-4",children:t.jsxs("div",{className:"max-w-xl mx-auto bg-white p-8 rounded-2xl shadow-xl",children:[t.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-[#C30010]",children:"Upload Outdoor Location Image"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("input",{type:"text",placeholder:"Location",value:l,onChange:e=>n(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg"}),t.jsx("input",{type:"text",placeholder:"Size",value:g,onChange:e=>w(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg"}),t.jsx("input",{type:"text",placeholder:"Type",value:m,onChange:e=>b(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg"}),t.jsxs("select",{value:h,onChange:e=>y(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",children:[t.jsx("option",{value:"",children:"-- Select Slug --"}),t.jsx("option",{value:"static",children:"Static"}),t.jsx("option",{value:"screen",children:"Screen"})]}),t.jsx("input",{type:"number",placeholder:"Image Order",value:v,readOnly:!0,onChange:e=>x(Number(e.target.value)),className:"w-full p-3 border border-gray-300 rounded-lg"}),t.jsxs("label",{className:"block w-full cursor-pointer bg-[#C30010] text-white text-center py-3 rounded-lg hover:bg-red-700 transition",children:[s?"Uploading...":"Choose Image",t.jsx("input",{type:"file",accept:"image/*",hidden:!0,onChange:N})]}),i&&t.jsx("div",{className:"mt-4",children:t.jsx("img",{src:i,alt:"Preview",className:"w-full rounded-lg shadow-md"})}),t.jsx("button",{onClick:C,disabled:s,className:"w-full bg-black text-white py-3 rounded-lg font-semibold hover:bg-gray-800 transition",children:s?"Uploading...":"Submit"})]})]})})};export{D as default};
